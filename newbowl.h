#include "GL/gl.h"

static GLfloat GL3DS_MATERIAL_newbowl[12] = {
1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000,
1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000,
1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000, 1.00000000000000000000};

static GLfloat GL3DS_VERTEX_newbowl[1440];
static GLuint GL3DS_INDEX_newbowl[] = {
0,10,1,
0,1,10,
0,9,10,
0,10,9,
1,11,2,
1,2,11,
1,10,11,
1,11,10,
2,12,3,
2,3,12,
2,11,12,
2,12,11,
3,13,4,
3,4,13,
3,12,13,
3,13,12,
4,14,5,
4,5,14,
4,13,14,
4,14,13,
5,15,6,
5,6,15,
5,14,15,
5,15,14,
6,16,7,
6,7,16,
6,15,16,
6,16,15,
7,17,8,
7,8,17,
7,16,17,
7,17,16,
9,19,10,
9,10,19,
9,18,19,
9,19,18,
10,20,11,
10,11,20,
10,19,20,
10,20,19,
11,21,12,
11,12,21,
11,20,21,
11,21,20,
12,22,13,
12,13,22,
12,21,22,
12,22,21,
13,23,14,
13,14,23,
13,22,23,
13,23,22,
14,24,15,
14,15,24,
14,23,24,
14,24,23,
15,25,16,
15,16,25,
15,24,25,
15,25,24,
16,25,26,
16,26,25,
18,28,19,
18,19,28,
18,27,28,
18,28,27,
19,29,20,
19,20,29,
19,28,29,
19,29,28,
20,30,21,
20,21,30,
20,29,30,
20,30,29,
21,31,22,
21,22,31,
21,30,31,
21,31,30,
22,32,23,
22,23,32,
22,31,32,
22,32,31,
23,33,24,
23,24,33,
23,32,33,
23,33,32,
24,34,25,
24,25,34,
24,33,34,
24,34,33,
25,35,26,
25,26,35,
25,34,35,
25,35,34,
27,37,28,
27,28,37,
27,36,37,
27,37,36,
28,38,29,
28,29,38,
28,37,38,
28,38,37,
29,39,30,
29,30,39,
29,38,39,
29,39,38,
30,40,31,
30,31,40,
30,39,40,
30,40,39,
31,41,32,
31,32,41,
31,40,41,
31,41,40,
32,42,33,
32,33,42,
32,41,42,
32,42,41,
33,43,34,
33,34,43,
33,42,43,
33,43,42,
34,43,44,
34,44,43,
36,46,37,
36,37,46,
36,45,46,
36,46,45,
37,47,38,
37,38,47,
37,46,47,
37,47,46,
38,48,39,
38,39,48,
38,47,48,
38,48,47,
39,49,40,
39,40,49,
39,48,49,
39,49,48,
40,50,41,
40,41,50,
40,49,50,
40,50,49,
41,51,42,
41,42,51,
41,50,51,
41,51,50,
42,52,43,
42,43,52,
42,51,52,
42,52,51,
43,53,44,
43,44,53,
43,52,53,
43,53,52,
45,55,46,
45,46,55,
45,54,55,
45,55,54,
46,56,47,
46,47,56,
46,55,56,
46,56,55,
47,57,48,
47,48,57,
47,56,57,
47,57,56,
48,58,49,
48,49,58,
48,57,58,
48,58,57,
49,59,50,
49,50,59,
49,58,59,
49,59,58,
50,60,51,
50,51,60,
50,59,60,
50,60,59,
51,61,52,
51,52,61,
51,60,61,
51,61,60,
52,61,62,
52,62,61,
54,64,55,
54,55,64,
54,63,64,
54,64,63,
55,65,56,
55,56,65,
55,64,65,
55,65,64,
56,66,57,
56,57,66,
56,65,66,
56,66,65,
57,67,58,
57,58,67,
57,66,67,
57,67,66,
58,68,59,
58,59,68,
58,67,68,
58,68,67,
59,69,60,
59,60,69,
59,68,69,
59,69,68,
60,70,61,
60,61,70,
60,69,70,
60,70,69,
61,70,71,
61,71,70,
63,73,64,
63,64,73,
63,72,73,
63,73,72,
64,74,65,
64,65,74,
64,73,74,
64,74,73,
65,75,66,
65,66,75,
65,74,75,
65,75,74,
66,76,67,
66,67,76,
66,75,76,
66,76,75,
67,77,68,
67,68,77,
67,76,77,
67,77,76,
68,78,69,
68,69,78,
68,77,78,
68,78,77,
69,79,70,
69,70,79,
69,78,79,
69,79,78,
70,80,71,
70,71,80,
70,79,80,
70,80,79,
72,82,73,
72,73,82,
72,81,82,
72,82,81,
73,83,74,
73,74,83,
73,82,83,
73,83,82,
74,84,75,
74,75,84,
74,83,84,
74,84,83,
75,85,76,
75,76,85,
75,84,85,
75,85,84,
76,86,77,
76,77,86,
76,85,86,
76,86,85,
77,87,78,
77,78,87,
77,86,87,
77,87,86,
78,88,79,
78,79,88,
78,87,88,
78,88,87,
79,89,80,
79,80,89,
79,88,89,
79,89,88,
81,91,82,
81,82,91,
81,90,91,
81,91,90,
82,92,83,
82,83,92,
82,91,92,
82,92,91,
83,93,84,
83,84,93,
83,92,93,
83,93,92,
84,94,85,
84,85,94,
84,93,94,
84,94,93,
85,95,86,
85,86,95,
85,94,95,
85,95,94,
86,96,87,
86,87,96,
86,95,96,
86,96,95,
87,97,88,
87,88,97,
87,96,97,
87,97,96,
88,98,89,
88,89,98,
88,97,98,
88,98,97,
90,100,91,
90,91,100,
90,99,100,
90,100,99,
91,101,92,
91,92,101,
91,100,101,
91,101,100,
92,102,93,
92,93,102,
92,101,102,
92,102,101,
93,103,94,
93,94,103,
93,102,103,
93,103,102,
94,104,95,
94,95,104,
94,103,104,
94,104,103,
95,105,96,
95,96,105,
95,104,105,
95,105,104,
96,106,97,
96,97,106,
96,105,106,
96,106,105,
97,107,98,
97,98,107,
97,106,107,
97,107,106,
99,109,100,
99,100,109,
99,108,109,
99,109,108,
100,110,101,
100,101,110,
100,109,110,
100,110,109,
101,111,102,
101,102,111,
101,110,111,
101,111,110,
102,112,103,
102,103,112,
102,111,112,
102,112,111,
103,113,104,
103,104,113,
103,112,113,
103,113,112,
104,114,105,
104,105,114,
104,113,114,
104,114,113,
105,115,106,
105,106,115,
105,114,115,
105,115,114,
106,116,107,
106,107,116,
106,115,116,
106,116,115,
108,118,109,
108,109,118,
108,117,118,
108,118,117,
109,119,110,
109,110,119,
109,118,119,
109,119,118,
110,120,111,
110,111,120,
110,119,120,
110,120,119,
111,121,112,
111,112,121,
111,120,121,
111,121,120,
112,122,113,
112,113,122,
112,121,122,
112,122,121,
113,123,114,
113,114,123,
113,122,123,
113,123,122,
114,124,115,
114,115,124,
114,123,124,
114,124,123,
115,125,116,
115,116,125,
115,124,125,
115,125,124,
117,127,118,
117,118,127,
117,126,127,
117,127,126,
118,128,119,
118,119,128,
118,127,128,
118,128,127,
119,129,120,
119,120,129,
119,128,129,
119,129,128,
120,130,121,
120,121,130,
120,129,130,
120,130,129,
121,131,122,
121,122,131,
121,130,131,
121,131,130,
122,132,123,
122,123,132,
122,131,132,
122,132,131,
123,133,124,
123,124,133,
123,132,133,
123,133,132,
124,133,134,
124,134,133,
126,136,127,
126,127,136,
126,135,136,
126,136,135,
127,137,128,
127,128,137,
127,136,137,
127,137,136,
128,138,129,
128,129,138,
128,137,138,
128,138,137,
129,139,130,
129,130,139,
129,138,139,
129,139,138,
130,140,131,
130,131,140,
130,139,140,
130,140,139,
131,141,132,
131,132,141,
131,140,141,
131,141,140,
132,142,133,
132,133,142,
132,141,142,
132,142,141,
133,142,143,
133,143,142,
135,145,136,
135,136,145,
135,144,145,
135,145,144,
136,146,137,
136,137,146,
136,145,146,
136,146,145,
137,147,138,
137,138,147,
137,146,147,
137,147,146,
138,148,139,
138,139,148,
138,147,148,
138,148,147,
139,149,140,
139,140,149,
139,148,149,
139,149,148,
140,150,141,
140,141,150,
140,149,150,
140,150,149,
141,151,142,
141,142,151,
141,150,151,
141,151,150,
142,152,143,
142,143,152,
142,151,152,
142,152,151,
144,154,145,
144,145,154,
144,153,154,
144,154,153,
145,155,146,
145,146,155,
145,154,155,
145,155,154,
146,156,147,
146,147,156,
146,155,156,
146,156,155,
147,157,148,
147,148,157,
147,156,157,
147,157,156,
148,158,149,
148,149,158,
148,157,158,
148,158,157,
149,159,150,
149,150,159,
149,158,159,
149,159,158,
150,160,151,
150,151,160,
150,159,160,
150,160,159,
151,160,161,
151,161,160,
153,163,154,
153,154,163,
153,162,163,
153,163,162,
154,164,155,
154,155,164,
154,163,164,
154,164,163,
155,165,156,
155,156,165,
155,164,165,
155,165,164,
156,166,157,
156,157,166,
156,165,166,
156,166,165,
157,167,158,
157,158,167,
157,166,167,
157,167,166,
158,168,159,
158,159,168,
158,167,168,
158,168,167,
159,169,160,
159,160,169,
159,168,169,
159,169,168,
160,170,161,
160,161,170,
160,169,170,
160,170,169,
162,172,163,    //
162,163,172,
162,171,172,
162,172,171,
163,173,164,
163,164,173,
163,172,173,
163,173,172,
164,174,165,
164,165,174,
164,173,174,
164,174,173,
165,175,166,
165,166,175,
165,174,175,
165,175,174,
166,176,167,
166,167,176,
166,175,176,
166,176,175,
167,177,168,
167,168,177,
167,176,177,
167,177,176,
168,178,169,
168,169,178,
168,177,178,
168,178,177,
169,178,179,
169,179,178,
171,1,172,
171,172,1,
171,0,1,
171,1,0,
172,2,173,
172,173,2,
172,1,2,
172,2,1,
173,3,174,
173,174,3,
173,2,3,
173,3,2,
174,4,175,
174,175,4,
174,3,4,
174,4,3,
175,5,176,
175,176,5,
175,4,5,
175,5,4,
176,6,177,
176,177,6,
176,5,6,
176,6,5,
177,7,178,
177,178,7,
177,6,7,
177,7,6,
178,8,179,
178,179,8,
178,7,8,
178,8,7};

int swap_yz(){
    FILE *out;
    if (!(out = fopen("../new_bowl20.gl", "w")))
        return(-1);
    GLfloat tmp;
    for(int i=0; i < 180; ++i){
        int v0, v1, v2;
        v0 = i * 8 + 5;
        v1 = v0 + 1;
        v2 = v1 + 1;
        tmp = GL3DS_VERTEX_newbowl[v1];
        GL3DS_VERTEX_newbowl[v1] = GL3DS_VERTEX_newbowl[v2];
        GL3DS_VERTEX_newbowl[v2] = tmp;
    }
    if (fwrite(GL3DS_VERTEX_newbowl, 5760, 1, out) != 1)
        return(-1);
    fclose(out);
    return 0;
}


int get_vertices(GLfloat m[]){
    FILE *in;
    if (!(in = fopen("../new_bowl20.gl", "r")))
        return(-1);
    for(int i=0; i < 180; ++i){
        int v0, v1, v2;
        v0 = i * 8 + 5;
        v1 = v0 + 1;
        v2 = v1 + 1;
        m[i*3] = GL3DS_VERTEX_newbowl[v0];
        m[i*3+1] = GL3DS_VERTEX_newbowl[v1];
        m[i*3+2] = GL3DS_VERTEX_newbowl[v2];
    }
    fclose(in);
    return 0;
}


int GL3DS_initialize_newbowl() {
  int ReturnVal;
  FILE *in;
  if (!(in = fopen("../new_bowl20.gl", "rb")))
    return(-1);
  if (fread(GL3DS_VERTEX_newbowl, 5760, 1, in) != 1)
    return(-1);
  fclose(in);
//  swap_yz();
  ReturnVal = glGenLists(1);
  glInterleavedArrays(GL_T2F_N3F_V3F, 0, GL3DS_VERTEX_newbowl); // 激活并存储顶点
  glNewList(ReturnVal, GL_COMPILE);
    glFrontFace(GL_CCW);
    glEnable(GL_CULL_FACE);
    glCullFace(GL_BACK);
//    glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);
    glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
    glMaterialfv(GL_FRONT, GL_AMBIENT, (GLfloat *) &GL3DS_MATERIAL_newbowl[0]);
    glMaterialfv(GL_FRONT, GL_DIFFUSE, (GLfloat *) &GL3DS_MATERIAL_newbowl[4]);
    glMaterialfv(GL_FRONT, GL_SPECULAR, (GLfloat *) &GL3DS_MATERIAL_newbowl[8]);
//    glDrawElements(GL_TRIANGLES, 1872, GL_UNSIGNED_INT, &GL3DS_INDEX_newbowl[0]);   // 624 个三角形， 每个为三元组，对应三个顶点，共 1872
    glDrawElements(GL_TRIANGLES, 186, GL_UNSIGNED_INT, &GL3DS_INDEX_newbowl[0]);   // 624 个三角形，
    glDrawElements(GL_TRIANGLES, 186, GL_UNSIGNED_INT, &GL3DS_INDEX_newbowl[1872-186]);   // 624 个三角形
    glEndList();

    return (ReturnVal);
}
